---
import "../styles/global.css";
import Hero from "../components/Hero.astro";
import About from "../components/About.astro";
import Education from "../components/Education.astro";
import Experience from "../components/Experience.astro";
import Publications from "../components/Publications.astro";
import SkillsGrid from "../components/SkillsGrid.astro";
import FeaturedProjects from "../components/FeaturedProjects.astro";
import Contact from "../components/Contact.astro";
import ThemeToggle from "../components/ThemeToggle.astro";
import { fetchTopRepos } from "../lib/github";

/* Build-time repo fetch using src/lib/github.ts which supports caching and GITHUB_TOKEN.
   Provide a GITHUB_TOKEN env var in CI or local environment to increase rate limits:
     export GITHUB_TOKEN=ghp_xxx
*/
const repos = await fetchTopRepos("Shrest4647", {
  count: 6,
  ttlSeconds: 60 * 60,
});
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <script is:inline>
      (function () {
        try {
          const stored = localStorage.getItem("theme");
          const systemDark =
            window.matchMedia &&
            window.matchMedia("(prefers-color-scheme: dark)").matches;
          const isDark = stored ? stored === "dark" : systemDark;
          if (isDark) document.documentElement.classList.add("dark");
          else document.documentElement.classList.remove("dark");
        } catch (_) {
          /* no-op */
        }
      })();
    </script>
    <title>Sunil Shrestha — Researcher & Engineer</title>
    <meta
      name="description"
      content="Sunil Shrestha — Computer Engineer and Aspiring Researcher in Distributed Systems & Machine Learning."
    />
    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="Sunil Shrestha — Researcher & Engineer"
    />
    <meta
      property="og:description"
      content="Computer Engineer and Aspiring Researcher in Distributed Systems & Machine Learning."
    />
    <meta property="og:url" content="https://sunilshrestha.com" />
    <meta
      property="og:image"
      content="https://avatars.githubusercontent.com/u/35072109?v=4"
    />
    <meta property="og:image:alt" content="Sunil Shrestha" />
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="Sunil Shrestha — Researcher & Engineer"
    />
    <meta
      name="twitter:description"
      content="Computer Engineer and Aspiring Researcher in Distributed Systems & Machine Learning."
    />
    <meta
      name="twitter:image"
      content="https://avatars.githubusercontent.com/u/35072109?v=4"
    />
    <link rel="canonical" href="https://sunilshrestha.com" />

    <!-- JSON-LD: Person -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Sunil Shrestha",
        "url": "https://sunilshrestha.com",
        "sameAs": [
          "https://github.com/Shrest4647",
          "https://linkedin.com/in/shrest",
          "https://twitter.com/4647sunil"
        ],
        "image": "https://avatars.githubusercontent.com/u/35072109?v=4",
        "jobTitle": "Researcher & Engineer",
        "description": "Computer Engineer and Aspiring Researcher in Distributed Systems & Machine Learning."
      }
    </script>
  </head>

  <body class="antialiased">
    <Hero />
    <About />
    <Education />
    <Experience />
    <Publications />
    <SkillsGrid />
    <FeaturedProjects repos={repos} />
    <Contact />
    <ThemeToggle />

    <footer class="py-8 text-center text-sm text-slate-600">
      <div class="container mx-auto px-6">
        © {new Date().getFullYear()} Sunil Shrestha — Built with Astro.
      </div>
    </footer>
  </body>
</html>
